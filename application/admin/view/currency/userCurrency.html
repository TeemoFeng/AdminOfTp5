{include file="common/head"/}
<div class="admin-main layui-anim layui-anim-upbit">
    <fieldset class="layui-elem-field layui-field-title">
        <legend>用户货币</legend>
    </fieldset>

    <div class="layui-tab layui-tab-brief" lay-filter="userAccount">
        <ul class="layui-tab-title">
            <ul class="layui-tab-title">
                {foreach $currency_list as $k => $v }
                <li {if condition="$k eq '0'"}class="layui-this"{/if}>{$v['name']}</li>
                {/foreach}
            </ul>
        </ul>
        <div class="layui-tab-content" style="height: 100px;">
            {foreach $currency_list as $k => $v }
                {if condition="$k eq '0'"}
                <div class="layui-tab-item layui-show">
                {else /}
                <div class="layui-tab-item">
                {/if}
                    <div class="demoTable layui-form">
                        <div class="layui-inline">
                            <input class="layui-input" name="key{$key}" id="key{$key}" placeholder="请输入关键字">

                        </div>
                        <button class="layui-btn" id="search{$v['id']}"  data-type="reload">搜索</button>
                        <input type="hidden" id="currency_id{$key}" value="{$v['id']}">
                    </div>
                    <table class="layui-table" id="table{$key}" lay-filter="table{$key}"></table>
                </div>
                {/foreach}

        </div>
    </div>
</div>


<script type="text/html" id="action">
    <a href="{:url('applyDetail')}?id={{d.id}}" class="layui-btn layui-btn-primary layui-btn-xs">查看备注</a>

</script>


<script type="text/html" id="topBtn">

</script>

{include file="common/foot"/}
<script>
    layui.use(['table','form','laydate','element'], function() {
        var table = layui.table,form = layui.form, $ = layui.jquery, laydate = layui.laydate, element = layui.element;

        var show_table = function(_type){
            //获取对应表的币种id
            var currency_id = $("#currency_id"+_type).val();
            table.render({
                id: 'table'+_type,
                elem: '#table'+_type,
                url: '{:url("userCurrency")}',
                where: {'currency_id':currency_id},
                method: 'post',
                toolbar: '#topBtn',
                page: true,
                cols: [[
                    {checkbox:true,fixed: true},
                    {field: 'id', title: 'id', width: 100, fixed: true},
                    {field: 'username', title: '用户', width: 200, fixed: true},
                    {field: 'mobile', title: '手机号', width: 200},
                    {field: 'name', title: '货币', width: 200},
                    {field: 'num', title: '数量', width: 200},
                    {field: 'freeze_num', title: '冻结数量', width: 200},
                    {field: 'lock_num', title: '锁仓数量', width: 100},
                    {title:'操作', width: 100, align: 'center', toolbar: '#action'}
                ]],
                limit: 10 //每页默认显示的数量
            });
        };


        //搜索
        $('#search1').on('click', function() {
            var key = $('#key1').val();
            var start_time = $('#start_time1').val();
            var end_time = $('#end_time1').val();
            var running_type = $('#status1').val();
            // if($.trim(key)==='') {
            //     layer.msg('{:lang("pleaseEnter")}关键字！',{icon:0});
            //     return;
            // }
            table.reload('table1',{ page: {page: 1},where: {key: key, start_time:start_time, end_time:end_time, running_type:running_type,account_type:1}})
        });

        //搜索2
        $('#search2').on('click', function() {
            var key = $('#key2').val();
            var start_time = $('#start_time2').val();
            var end_time = $('#end_time2').val();
            var running_type = $('#status2').val();
            table.reload('table2',{ page: {page: 1},where: {key: key, start_time:start_time, end_time:end_time, running_type:running_type,account_type:2}})
        });

        //搜索3
        $('#search3').on('click', function() {
            var key = $('#key3').val();
            var start_time = $('#start_time3').val();
            var end_time = $('#end_time3').val();
            var running_type = $('#status3').val();
            table.reload('table3',{ page: {page: 1},where: {key: key, start_time:start_time, end_time:end_time, running_type:running_type,account_type:3}})
        });

        //搜索4
        $('#search4').on('click', function() {
            var key = $('#key4').val();
            var start_time = $('#start_time4').val();
            var end_time = $('#end_time4').val();
            var running_type = $('#status4').val();
            table.reload('table4',{ page: {page: 1},where: {key: key, start_time:start_time, end_time:end_time, running_type:running_type,account_type:4}})
        });

        //搜索5
        $('#search5').on('click', function() {
            var key = $('#key5').val();
            var start_time = $('#start_time5').val();
            var end_time = $('#end_time5').val();
            var running_type = $('#status5').val();
            table.reload('table5',{ page: {page: 1},where: {key: key, start_time:start_time, end_time:end_time, running_type:running_type,account_type:5}})
        });

        show_table(0);

        element.on('tab(userAccount)', function (data) {
            var index = data.index;
            $('#key'+index).val('');
            show_table(index);
        });

    });
</script>
</body>
</html>